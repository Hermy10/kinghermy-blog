---
import BaseLayout from '../layouts/BaseLayout.astro'
import { SITE_BASE, SocialLinks } from '../consts'
import { Icon } from 'astro-icon/components'
import BlogCard from '../components/BlogCard.astro'
import { getCollection } from 'astro:content'
import { Image } from 'astro:assets'
import crownAvatar from '../assets/crown.png'

const allPosts = await getCollection('blog')
const posts = allPosts
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 4)
const totalPosts = allPosts.length
---

<BaseLayout>
	<main
		class="app-container relative py-28 md:py-36 flex flex-col items-center text-center"
	>
		<div class="absolute inset-0 blur-3xl opacity-40 pointer-events-none">
			<div class="w-72 h-72 bg-primary/40 rounded-full absolute -left-12 top-0">
			</div>
			<div
				class="w-80 h-80 bg-primary/30 rounded-full absolute right-4 bottom-0"
			>
			</div>
		</div>

		<div
			class="relative card-surface hero-surface rounded-3xl p-8 md:p-12 overflow-hidden max-w-5xl w-full text-center"
		>
			<div class="flex flex-col gap-8 max-w-4xl mx-auto items-center">
				<div class="pill w-fit">
					<Icon name="mdi:crown" /> Kinghermy
				</div>
				<div class="flex flex-col items-center gap-4 pt-2">
					<div
						class="w-36 h-36 rounded-full overflow-hidden border-2 border-amber-300/80 bg-black/70 shadow-xl"
					>
						<Image
							src={crownAvatar}
							alt="Kinghermy display"
							class="w-full h-full object-cover"
						/>
					</div>
					<div class="space-y-1">
						<p class="text-sm uppercase tracking-[0.16em] opacity-70">
							Kinghermy's Blog
						</p>
					</div>
				</div>
				<div class="space-y-4">
					<h1
						class="text-4xl sm:text-5xl md:text-6xl font-extrabold leading-tight tracking-tight bg-gradient-to-r from-amber-300 via-amber-400 to-orange-500 bg-clip-text text-transparent"
					>
						Ethical Hacker, Pen Tester, and Fraghead
					</h1>
					<p class="text-xl md:text-2xl max-w-3xl leading-relaxed opacity-90">
						Ethical hacker and penetration tester who geeks out about fragrance
						and philosophy. Field notes on security, scent, curiosity, and the
						stories in between.
					</p>
				</div>

				<div class="flex flex-wrap gap-4">
					<a class="btn-primary" href={`${SITE_BASE}/blog`}>
						Read the blog <Icon name="mdi:arrow-top-right-thin" />
					</a>
					<a class="btn-secondary" href={`${SITE_BASE}/about`}>
						About me <Icon name="mdi:account-circle-outline" />
					</a>
				</div>

				<div class="flex flex-wrap items-center gap-3 pt-2">
					<div class="pill">
						<Icon name="mdi:book-open-variant" />
						{totalPosts} posts and counting
					</div>
					<div class="pill">
						<Icon name="mdi:bug-outline" /> Curiosity & bug hunting
					</div>
				</div>

				<div class="flex flex-wrap gap-3 pt-4">
					{
						SocialLinks.map((link) => (
							<a
								class="pill hover:-translate-y-[2px] transition-transform"
								href={link.url}
								target="_blank"
							>
								<Icon name="mdi:arrow-top-right" />
								{link.name}
							</a>
						))
					}
				</div>
			</div>
		</div>
	</main>

	<!-- Recent Posts Section -->
	<section class="app-container">
		<div
			class="flex flex-col md:flex-row md:items-center md:justify-between gap-4"
		>
			<div>
				<h2 class="section-title">Recent Posts</h2>
				<p class="text-lg opacity-80">Fresh drops from the lab.</p>
			</div>
			<a class="btn-secondary" href={`${SITE_BASE}/blog`}
				>Read all
				<Icon size={20} name="mdi:arrow-right" />
			</a>
		</div>
		<div class="posts-grid-container">
			{posts.map((post) => <BlogCard post={post} />)}
		</div>
	</section>

	<section class="app-container py-42 grid lg:grid-cols-2 gap-12 lg:gap-10">
		<div class="card-surface rounded-2xl p-8 space-y-6">
			<h2 class="section-title">About Me</h2>
			<p class="text-lg leading-relaxed opacity-90">
				Hey, I’m Kinghermy. I tinker with code, write down what I learn, and
				share the messy middle of projects so others can follow along.
			</p>
			<a class="btn-secondary" href={`${SITE_BASE}/about`}
				>Go to About
				<Icon size={20} name="mdi:arrow-right" />
			</a>
		</div>
		<div class="card-surface rounded-2xl p-8 space-y-6">
			<h2 class="section-title">Get in touch</h2>
			<p class="text-lg leading-relaxed opacity-90">
				Want to collaborate or say hi? I’m always up for chatting about code,
				ideas, and new experiments.
			</p>
			<div class="flex flex-wrap mt-auto gap-3">
				<a
					class="btn-primary"
					href="mailto:generalherminius@gmail.com"
					target="_blank"
					>Get in touch
					<Icon height={20} name="mdi:email" />
				</a>
				<a
					class="btn-secondary"
					href="https://github.com/hermy10"
					target="_blank"
					>View GitHub
					<Icon height={20} name="mdi:arrow-right" />
				</a>
			</div>
		</div>
	</section>
</BaseLayout>
