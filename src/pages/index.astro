---
import BaseLayout from '../layouts/BaseLayout.astro'
import { SITE_BASE, SocialLinks } from '../consts'
import { Icon } from 'astro-icon/components'
import BlogCard from '../components/BlogCard.astro'
import { getCollection } from 'astro:content'

const allPosts = await getCollection('blog')
const posts = allPosts
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 4)
const totalPosts = allPosts.length
---

<BaseLayout>
	<main class="app-container relative py-28 md:py-36">
		<div class="absolute inset-0 blur-3xl opacity-40 pointer-events-none">
			<div class="w-72 h-72 bg-primary/40 rounded-full absolute -left-12 top-0"></div>
			<div class="w-80 h-80 bg-primary/30 rounded-full absolute right-4 bottom-0"></div>
		</div>

		<div
			class="relative card-surface rounded-3xl p-8 md:p-12 overflow-hidden border border-white/30 dark:border-white/10"
		>
			<div class="flex flex-col gap-8 max-w-4xl">
				<div class="pill w-fit">
					<Icon name="mdi:crown" /> Kinghermy / Building in public
				</div>
				<div class="space-y-4">
					<h1
						class="text-5xl sm:text-6xl md:text-7xl font-black leading-tight tracking-tight"
					>
						<span class="bg-gradient-to-r from-primary via-amber-400 to-orange-400 bg-clip-text text-transparent">
							You should see me in a crown.
						</span>
					</h1>
					<p class="text-xl md:text-2xl max-w-3xl leading-relaxed opacity-90">
						I tinker, ship, and share the messy middle so you can follow along.
						Notes, experiments, and observations on what I’m building and
						learning.
					</p>
				</div>

				<div class="flex flex-wrap gap-4">
					<a class="btn-primary" href={`${SITE_BASE}/blog`}>
						Read the blog <Icon name="mdi:arrow-top-right-thin" />
					</a>
					<a class="btn-secondary" href={`${SITE_BASE}/about`}>
						About me <Icon name="mdi:account-circle-outline" />
					</a>
				</div>

				<div class="flex flex-wrap items-center gap-3 pt-2">
					<div class="pill">
						<Icon name="mdi:book-open-variant" /> {totalPosts} posts and
						counting
					</div>
					<div class="pill">
						<Icon name="mdi:rocket-launch-outline" /> Building in public
					</div>
				</div>

				<div class="flex flex-wrap gap-3 pt-4">
					{
						SocialLinks.map((link) => (
							<a
								class="pill hover:-translate-y-[2px] transition-transform"
								href={link.url}
								target="_blank"
							>
								<Icon name="mdi:arrow-top-right" />
								{link.name}
							</a>
						))
					}
				</div>
			</div>
		</div>
	</main>

	<!-- Recent Posts Section -->
	<section class="app-container">
		<div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
			<div>
				<h2 class="section-title">Recent Posts</h2>
				<p class="text-lg opacity-80">Fresh drops from the lab.</p>
			</div>
			<a class="btn-secondary" href={`${SITE_BASE}/blog`}
				>Read all
				<Icon size={20} name="mdi:arrow-right" />
			</a>
		</div>
		<div class="posts-grid-container">
			{posts.map((post) => <BlogCard post={post} />)}
		</div>
	</section>

	<section class="app-container py-42 grid lg:grid-cols-2 gap-12 lg:gap-10">
		<div class="card-surface rounded-2xl p-8 space-y-6">
			<h2 class="section-title">About Me</h2>
			<p class="text-lg leading-relaxed opacity-90">
				Hey, I’m Kinghermy. I tinker with code, write down what I learn, and
				share the messy middle of projects so others can follow along.
			</p>
			<a class="btn-secondary" href={`${SITE_BASE}/about`}
				>Go to About
				<Icon size={20} name="mdi:arrow-right" />
			</a>
		</div>
		<div class="card-surface rounded-2xl p-8 space-y-6">
			<h2 class="section-title">Get in touch</h2>
			<p class="text-lg leading-relaxed opacity-90">
				Want to collaborate or say hi? I’m always up for chatting about code,
				ideas, and new experiments.
			</p>
			<div class="flex flex-wrap mt-auto gap-3">
				<a
					class="btn-primary"
					href="mailto:generalherminius@gmail.com"
					target="_blank"
					>Get in touch
					<Icon height={20} name="mdi:email" />
				</a>
				<a
					class="btn-secondary"
					href="https://github.com/hermy10"
					target="_blank"
					>View GitHub
					<Icon height={20} name="mdi:arrow-right" />
				</a>
			</div>
		</div>
	</section>
</BaseLayout>
